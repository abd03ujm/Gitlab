type: scan_execution_policy
name: "Block MR for 10 days if vulnerabilities found"
enabled: true
rules:
  - type: scan_finding    # This tells GitLab we're setting a rule for vulnerabilities found
    cadence: all          # Runs the policy every time the scan runs
    scanners:
      - sast
      - dependency_scanning
    severity_levels:
      - critical
      - high
    branches:
      - main
      - develop
    actions:
      - type: block_merge_request
        condition: "if vulnerability detected"
