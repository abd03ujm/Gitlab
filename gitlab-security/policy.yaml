type: scan_result_policy
name: "Block MR if vulnerabilities found"
enabled: true
approval_settings:
  auto_approve: false  # Ensures manual approval if a vulnerability is found
rules:
  - type: scan_finding   # Correct type for scan-based policies
    branch_type: target  # The policy applies to the target branch (e.g., main)
    scanners:
      - sast
      - dependency_scanning
    severity_levels:
      - critical
      - high
    branches:
      - main
      - develop
    actions:
      - type: block_merge_request  # Action to block MR if vulnerability is found
